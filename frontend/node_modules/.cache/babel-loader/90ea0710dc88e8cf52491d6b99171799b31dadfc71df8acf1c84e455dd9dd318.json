{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport axios from '../AxiosConfig.js';\nfunction useTaskActions(endpoint, id, subtasks, parentEndpoint) {\n  _s();\n  const [items, setItems] = useState([]);\n  const [refresh, setRefresh] = useState(true); // Initialize with true to fetch data on mount\n  const [taskdelete, setDelete] = useState(false);\n  const fetchData = () => {\n    axios.get(`/${endpoint}/${id}/${subtasks}`, {\n      headers: {\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      }\n    }).then(response => {\n      console.log(\"Fetched items:\", response.data);\n      setItems(response.data);\n    }).catch(error => {\n      console.error(`Error fetching ${endpoint}:`, error);\n    });\n  };\n  const fetchParent = async () => {\n    const parentid = await getParentTaskId();\n    await axios.delete(`/${endpoint}/${id}`);\n    if (endpoint === 'tasks') {\n      axios.get(`/tasks`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n    } else {\n      axios.get(`/${parentEndpoint}/${parentid}/${endpoint}`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setDelete(false).then(response => {\n        setItems(response.data);\n      }).catch(error => {\n        console.error(`Error fetching ${endpoint}:`, error);\n      });\n    }\n    ;\n  };\n  useEffect(() => {\n    if (refresh) {\n      fetchData();\n      setRefresh(false); // Reset refresh state after fetching\n    }\n  }, [refresh]);\n  const getParentTaskId = async () => {\n    try {\n      const response = await axios.get(`/${endpoint}/${id}`);\n      const data = response.data;\n      if (parentEndpoint === 'subtasks') {\n        return data.task_id; // Return task_id for subtasks\n      } else if (parentEndpoint === 'subsubtasks') {\n        return data.subtask_id; // Return subtask_id for subsubtask\n      } else if (parentEndpoint === 'tasks') {\n        return 0; // Return 0 for a task\n      }\n    } catch (error) {\n      console.error(`Error fetching parent ID for ${parentEndpoint}:`, error);\n      return null;\n    }\n  };\n  const handleDelete = async itemId => {\n    try {\n      console.log(\"Attempting to delete item with ID:\", itemId);\n      await axios.delete(`/${endpoint}/${itemId}`);\n      fetchData();\n      setRefresh(true);\n    } catch (error) {\n      console.error(`Error deleting ${endpoint}:`, error);\n    }\n  };\n  const handleAdd = title => {\n    axios.post(`/${endpoint}/${id}/${subtasks}`, {\n      title\n    }).then(() => {\n      setRefresh(true); // Trigger a refresh after successful addition\n    }).catch(error => {\n      console.error(`Error adding to ${endpoint}:`, error);\n    });\n  };\n  return {\n    items,\n    handleDelete,\n    handleAdd,\n    fetchData\n  };\n}\n_s(useTaskActions, \"BrhWS46g+5xVlNwNmpNaLk9Alx8=\");\nexport default useTaskActions;","map":{"version":3,"names":["useState","useEffect","axios","useTaskActions","endpoint","id","subtasks","parentEndpoint","_s","items","setItems","refresh","setRefresh","taskdelete","setDelete","fetchData","get","headers","localStorage","getItem","then","response","console","log","data","catch","error","fetchParent","parentid","getParentTaskId","delete","task_id","subtask_id","handleDelete","itemId","handleAdd","title","post"],"sources":["/Users/davicoscarelli/Documents/GitHub/makowebapp/frontend/src/components/useTaskActions.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport axios from '../AxiosConfig.js';\n\nfunction useTaskActions(endpoint, id, subtasks, parentEndpoint) {\n    const [items, setItems] = useState([]);\n    const [refresh, setRefresh] = useState(true); // Initialize with true to fetch data on mount\n    const [taskdelete, setDelete] = useState(false);\n\n    const fetchData = () => {\n        axios.get(`/${endpoint}/${id}/${subtasks}`, {\n            headers: {\n                'Authorization': `Bearer ${localStorage.getItem('token')}`\n            }\n        })\n        .then(response => {\n            console.log(\"Fetched items:\", response.data);\n\n            setItems(response.data);\n        })\n        .catch(error => {\n            console.error(`Error fetching ${endpoint}:`, error);\n        });\n    }\n\n    const fetchParent = async () => {\n        const parentid = await getParentTaskId();\n        await axios.delete(`/${endpoint}/${id}`);\n        if (endpoint === 'tasks') {\n            axios.get(`/tasks`, {\n                headers: {\n                    'Authorization': `Bearer ${localStorage.getItem('token')}`\n                }\n            })\n            \n        } else {\n            axios.get(`/${parentEndpoint}/${parentid}/${endpoint}`, {\n                headers: {\n                    'Authorization': `Bearer ${localStorage.getItem('token')}`\n                }\n            })\n            setDelete(false)\n            .then(response => {\n                setItems(response.data);\n            })\n            .catch(error => {\n                console.error(`Error fetching ${endpoint}:`, error);\n            })\n        }\n        ;\n    }\n    \n    useEffect(() => {\n        if (refresh) {\n            fetchData();\n            setRefresh(false); // Reset refresh state after fetching\n        }\n    }, [refresh]);\n\n\n    const getParentTaskId = async () => {\n        try {\n            const response = await axios.get(`/${endpoint}/${id}`);\n            const data = response.data;\n    \n            if (parentEndpoint === 'subtasks') {\n                return data.task_id; // Return task_id for subtasks\n            } else if (parentEndpoint === 'subsubtasks') {\n                return data.subtask_id; // Return subtask_id for subsubtask\n            } else if (parentEndpoint === 'tasks') {\n                return 0; // Return 0 for a task\n            }\n        } catch (error) {\n            console.error(`Error fetching parent ID for ${parentEndpoint}:`, error);\n            return null;\n        }\n    };\n    \n    const handleDelete = async (itemId) => {\n        try {\n            console.log(\"Attempting to delete item with ID:\", itemId);\n\n            await axios.delete(`/${endpoint}/${itemId}`);\n            fetchData();\n            setRefresh(true);\n        } catch (error) {\n            console.error(`Error deleting ${endpoint}:`, error);\n        }\n    };\n\n\n    const handleAdd = (title) => {\n        axios.post(`/${endpoint}/${id}/${subtasks}`, { title })\n            .then(() => {\n                setRefresh(true);// Trigger a refresh after successful addition\n            })\n            .catch(error => {\n                console.error(`Error adding to ${endpoint}:`, error);\n            });\n    };\n\n    return {\n        items,\n        handleDelete,\n        handleAdd, \n        fetchData\n    };\n}\n\nexport default useTaskActions;"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,OAAOC,KAAK,MAAM,mBAAmB;AAErC,SAASC,cAAcA,CAACC,QAAQ,EAAEC,EAAE,EAAEC,QAAQ,EAAEC,cAAc,EAAE;EAAAC,EAAA;EAC5D,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACW,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EAC9C,MAAM,CAACa,UAAU,EAAEC,SAAS,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EAE/C,MAAMe,SAAS,GAAGA,CAAA,KAAM;IACpBb,KAAK,CAACc,GAAG,CAAE,IAAGZ,QAAS,IAAGC,EAAG,IAAGC,QAAS,EAAC,EAAE;MACxCW,OAAO,EAAE;QACL,eAAe,EAAG,UAASC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAE;MAC7D;IACJ,CAAC,CAAC,CACDC,IAAI,CAACC,QAAQ,IAAI;MACdC,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEF,QAAQ,CAACG,IAAI,CAAC;MAE5Cd,QAAQ,CAACW,QAAQ,CAACG,IAAI,CAAC;IAC3B,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,IAAI;MACZJ,OAAO,CAACI,KAAK,CAAE,kBAAiBtB,QAAS,GAAE,EAAEsB,KAAK,CAAC;IACvD,CAAC,CAAC;EACN,CAAC;EAED,MAAMC,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC5B,MAAMC,QAAQ,GAAG,MAAMC,eAAe,CAAC,CAAC;IACxC,MAAM3B,KAAK,CAAC4B,MAAM,CAAE,IAAG1B,QAAS,IAAGC,EAAG,EAAC,CAAC;IACxC,IAAID,QAAQ,KAAK,OAAO,EAAE;MACtBF,KAAK,CAACc,GAAG,CAAE,QAAO,EAAE;QAChBC,OAAO,EAAE;UACL,eAAe,EAAG,UAASC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAE;QAC7D;MACJ,CAAC,CAAC;IAEN,CAAC,MAAM;MACHjB,KAAK,CAACc,GAAG,CAAE,IAAGT,cAAe,IAAGqB,QAAS,IAAGxB,QAAS,EAAC,EAAE;QACpDa,OAAO,EAAE;UACL,eAAe,EAAG,UAASC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAE;QAC7D;MACJ,CAAC,CAAC;MACFL,SAAS,CAAC,KAAK,CAAC,CACfM,IAAI,CAACC,QAAQ,IAAI;QACdX,QAAQ,CAACW,QAAQ,CAACG,IAAI,CAAC;MAC3B,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,IAAI;QACZJ,OAAO,CAACI,KAAK,CAAE,kBAAiBtB,QAAS,GAAE,EAAEsB,KAAK,CAAC;MACvD,CAAC,CAAC;IACN;IACA;EACJ,CAAC;EAEDzB,SAAS,CAAC,MAAM;IACZ,IAAIU,OAAO,EAAE;MACTI,SAAS,CAAC,CAAC;MACXH,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;IACvB;EACJ,CAAC,EAAE,CAACD,OAAO,CAAC,CAAC;EAGb,MAAMkB,eAAe,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI;MACA,MAAMR,QAAQ,GAAG,MAAMnB,KAAK,CAACc,GAAG,CAAE,IAAGZ,QAAS,IAAGC,EAAG,EAAC,CAAC;MACtD,MAAMmB,IAAI,GAAGH,QAAQ,CAACG,IAAI;MAE1B,IAAIjB,cAAc,KAAK,UAAU,EAAE;QAC/B,OAAOiB,IAAI,CAACO,OAAO,CAAC,CAAC;MACzB,CAAC,MAAM,IAAIxB,cAAc,KAAK,aAAa,EAAE;QACzC,OAAOiB,IAAI,CAACQ,UAAU,CAAC,CAAC;MAC5B,CAAC,MAAM,IAAIzB,cAAc,KAAK,OAAO,EAAE;QACnC,OAAO,CAAC,CAAC,CAAC;MACd;IACJ,CAAC,CAAC,OAAOmB,KAAK,EAAE;MACZJ,OAAO,CAACI,KAAK,CAAE,gCAA+BnB,cAAe,GAAE,EAAEmB,KAAK,CAAC;MACvE,OAAO,IAAI;IACf;EACJ,CAAC;EAED,MAAMO,YAAY,GAAG,MAAOC,MAAM,IAAK;IACnC,IAAI;MACAZ,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEW,MAAM,CAAC;MAEzD,MAAMhC,KAAK,CAAC4B,MAAM,CAAE,IAAG1B,QAAS,IAAG8B,MAAO,EAAC,CAAC;MAC5CnB,SAAS,CAAC,CAAC;MACXH,UAAU,CAAC,IAAI,CAAC;IACpB,CAAC,CAAC,OAAOc,KAAK,EAAE;MACZJ,OAAO,CAACI,KAAK,CAAE,kBAAiBtB,QAAS,GAAE,EAAEsB,KAAK,CAAC;IACvD;EACJ,CAAC;EAGD,MAAMS,SAAS,GAAIC,KAAK,IAAK;IACzBlC,KAAK,CAACmC,IAAI,CAAE,IAAGjC,QAAS,IAAGC,EAAG,IAAGC,QAAS,EAAC,EAAE;MAAE8B;IAAM,CAAC,CAAC,CAClDhB,IAAI,CAAC,MAAM;MACRR,UAAU,CAAC,IAAI,CAAC,CAAC;IACrB,CAAC,CAAC,CACDa,KAAK,CAACC,KAAK,IAAI;MACZJ,OAAO,CAACI,KAAK,CAAE,mBAAkBtB,QAAS,GAAE,EAAEsB,KAAK,CAAC;IACxD,CAAC,CAAC;EACV,CAAC;EAED,OAAO;IACHjB,KAAK;IACLwB,YAAY;IACZE,SAAS;IACTpB;EACJ,CAAC;AACL;AAACP,EAAA,CAvGQL,cAAc;AAyGvB,eAAeA,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}