{"ast":null,"code":"var _jsxFileName = \"/Users/davicoscarelli/Documents/GitHub/makowebapp/frontend/src/components/TaskList.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from '../AxiosConfig.js';\nimport Task from './Task';\nimport useTaskActions from './useTaskActions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction TaskList() {\n  _s();\n  const [tasks, setTasks] = useState([]);\n  const [newTaskTitle, setNewTaskTitle] = useState('');\n  const navigate = useNavigate();\n  const [refresh, setRefresh] = useState(false); // Initialize with true to fetch data on mount\n  const {\n    handleDelete\n  } = useTaskActions('tasks', null, null, null);\n\n  // Function to fetch tasks from server\n  const fetchTasks = () => {\n    axios.get('/tasks').then(response => {\n      setTasks(response.data);\n    }).catch(error => {\n      console.error(\"Error fetching tasks:\", error);\n      if (error.response && error.response.status === 401) {\n        alert('Session expired. Please login again.');\n        navigate('/login');\n      }\n    });\n  };\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return;\n    }\n    fetchTasks();\n  }, [navigate, fetchTasks]);\n  useEffect(() => {\n    if (refresh) {\n      fetchTasks();\n      setRefresh(false); // Reset refresh state after fetching\n    }\n  }, [refresh, fetchTasks]);\n  const handleAddTask = () => {\n    axios.post('/tasks', {\n      title: newTaskTitle\n    }).then(response => {\n      setTasks([...tasks, response.data]);\n      setNewTaskTitle('');\n    }).catch(error => {\n      console.error(\"Error adding task:\", error);\n    });\n    fetchTasks();\n  };\n  const handleTaskDelete = task => {\n    handleDelete(task.id);\n\n    // try {\n    //     axios.delete(`/tasks/${task.id}`);\n    // } catch (error) {\n    //     console.error(`Error deleting task:`, error);\n    // }\n    // setRefresh(true); \n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [tasks.map(task => /*#__PURE__*/_jsxDEV(Task, {\n      task: task,\n      onDelete: () => handleTaskDelete(task),\n      onSubTaskDelete: fetchTasks // If you want to refresh after a subtask is deleted as well\n    }, task.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 17\n    }, this)), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      value: newTaskTitle,\n      onChange: e => setNewTaskTitle(e.target.value),\n      placeholder: \"New Task Title\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleAddTask,\n      children: \"Add Task\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 9\n  }, this);\n}\n_s(TaskList, \"9rr0avEimoFV3rNYjIe0ag+Am7c=\", false, function () {\n  return [useNavigate, useTaskActions];\n});\n_c = TaskList;\nexport default TaskList;\nvar _c;\n$RefreshReg$(_c, \"TaskList\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","axios","Task","useTaskActions","jsxDEV","_jsxDEV","TaskList","_s","tasks","setTasks","newTaskTitle","setNewTaskTitle","navigate","refresh","setRefresh","handleDelete","fetchTasks","get","then","response","data","catch","error","console","status","alert","token","localStorage","getItem","handleAddTask","post","title","handleTaskDelete","task","id","className","children","map","onDelete","onSubTaskDelete","fileName","_jsxFileName","lineNumber","columnNumber","type","value","onChange","e","target","placeholder","onClick","_c","$RefreshReg$"],"sources":["/Users/davicoscarelli/Documents/GitHub/makowebapp/frontend/src/components/TaskList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';  \nimport axios from '../AxiosConfig.js';\nimport Task from './Task';\nimport useTaskActions from './useTaskActions';\n\nfunction TaskList() {\n    const [tasks, setTasks] = useState([]);\n    const [newTaskTitle, setNewTaskTitle] = useState('');\n\n    const navigate = useNavigate();\n    const [refresh, setRefresh] = useState(false); // Initialize with true to fetch data on mount\n    const { handleDelete } = useTaskActions('tasks', null, null, null);\n\n\n    // Function to fetch tasks from server\n    const fetchTasks = () => {\n        axios.get('/tasks')\n            .then(response => {\n                setTasks(response.data);\n            })\n            .catch(error => {\n                console.error(\"Error fetching tasks:\", error);\n                if (error.response && error.response.status === 401) {\n                    alert('Session expired. Please login again.');\n                    navigate('/login');\n                }\n            });\n    };\n\n\n    \n    useEffect(() => {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n            navigate('/login');\n            return;\n        }\n\n        fetchTasks();\n    }, [navigate, fetchTasks]);\n\n    useEffect(() => {\n        if (refresh) {\n            fetchTasks();\n            setRefresh(false); // Reset refresh state after fetching\n        }\n    }, [refresh, fetchTasks]);\n\n    const handleAddTask = () => {\n        axios.post('/tasks', { title: newTaskTitle })\n            .then(response => {\n                setTasks([...tasks, response.data]);\n                setNewTaskTitle('');\n            })\n            .catch(error => {\n                console.error(\"Error adding task:\", error);\n            });\n        fetchTasks();\n    };\n\n    const handleTaskDelete = (task) => {\n        handleDelete(task.id);\n\n        // try {\n        //     axios.delete(`/tasks/${task.id}`);\n        // } catch (error) {\n        //     console.error(`Error deleting task:`, error);\n        // }\n        // setRefresh(true); \n        \n    };\n\n    return (\n        <div className=\"container\">\n            {tasks.map(task => (\n                <Task \n                    key={task.id} \n                    task={task} \n                    onDelete={() => handleTaskDelete(task)}\n                    onSubTaskDelete={fetchTasks}  // If you want to refresh after a subtask is deleted as well\n                />\n            ))}\n            <input \n                type=\"text\" \n                value={newTaskTitle} \n                onChange={e => setNewTaskTitle(e.target.value)} \n                placeholder=\"New Task Title\"\n            />\n            <button onClick={handleAddTask}>Add Task</button>\n        </div>\n    );\n}\n\nexport default TaskList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}